(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))M(_);new MutationObserver(_=>{for(const w of _)if(w.type==="childList")for(const g of w.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&M(g)}).observe(document,{childList:!0,subtree:!0});function h(_){const w={};return _.integrity&&(w.integrity=_.integrity),_.referrerpolicy&&(w.referrerPolicy=_.referrerpolicy),_.crossorigin==="use-credentials"?w.credentials="include":_.crossorigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function M(_){if(_.ep)return;_.ep=!0;const w=h(_);fetch(_.href,w)}})();(function(a,l){typeof define=="function"&&define.amd?define([],l):window.m4=l()})(globalThis,function(){let a=Float32Array;function l(e){const r=a;return a=e,r}function h(e,r,n){n=n||new a(16);var t=r[0*4+0],o=r[0*4+1],c=r[0*4+2],i=r[0*4+3],y=r[1*4+0],m=r[1*4+1],R=r[1*4+2],x=r[1*4+3],p=r[2*4+0],v=r[2*4+1],D=r[2*4+2],L=r[2*4+3],P=r[3*4+0],B=r[3*4+1],S=r[3*4+2],s=r[3*4+3],U=e[0*4+0],C=e[0*4+1],F=e[0*4+2],V=e[0*4+3],G=e[1*4+0],k=e[1*4+1],H=e[1*4+2],Y=e[1*4+3],j=e[2*4+0],W=e[2*4+1],J=e[2*4+2],$=e[2*4+3],d=e[3*4+0],ee=e[3*4+1],ne=e[3*4+2],te=e[3*4+3];return n[0]=t*U+o*G+c*j+i*d,n[1]=t*C+o*k+c*W+i*ee,n[2]=t*F+o*H+c*J+i*ne,n[3]=t*V+o*Y+c*$+i*te,n[4]=y*U+m*G+R*j+x*d,n[5]=y*C+m*k+R*W+x*ee,n[6]=y*F+m*H+R*J+x*ne,n[7]=y*V+m*Y+R*$+x*te,n[8]=p*U+v*G+D*j+L*d,n[9]=p*C+v*k+D*W+L*ee,n[10]=p*F+v*H+D*J+L*ne,n[11]=p*V+v*Y+D*$+L*te,n[12]=P*U+B*G+S*j+s*d,n[13]=P*C+B*k+S*W+s*ee,n[14]=P*F+B*H+S*J+s*ne,n[15]=P*V+B*Y+S*$+s*te,n}function M(e,r,n){return n=n||new a(3),n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n}function _(e,r,n){return n=n||new a(3),n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n}function w(e,r,n){return n=n||new a(3),n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n}function g(e,r){r=r||new a(3);var n=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return n>1e-5&&(r[0]=e[0]/n,r[1]=e[1]/n,r[2]=e[2]/n),r}function A(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}function N(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]}function b(e,r,n){return n=n||new a(3),n[0]=e[1]*r[2]-e[2]*r[1],n[1]=e[2]*r[0]-e[0]*r[2],n[2]=e[0]*r[1]-e[1]*r[0],n}function oe(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function K(e,r){const n=e[0]-r[0],t=e[1]-r[1],o=e[2]-r[2];return n*n+t*t+o*o}function ue(e,r){return Math.sqrt(K(e,r))}function le(e){return e=e||new a(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Q(e,r){return r=r||new a(16),r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15],r}function ie(e,r,n,t){t=t||new a(16);var o=g(_(e,r)),c=g(b(n,o)),i=g(b(o,c));return t[0]=c[0],t[1]=c[1],t[2]=c[2],t[3]=0,t[4]=i[0],t[5]=i[1],t[6]=i[2],t[7]=0,t[8]=o[0],t[9]=o[1],t[10]=o[2],t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function ve(e,r,n,t,o){o=o||new a(16);var c=Math.tan(Math.PI*.5-.5*e),i=1/(n-t);return o[0]=c/r,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=c,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(n+t)*i,o[11]=-1,o[12]=0,o[13]=0,o[14]=n*t*i*2,o[15]=0,o}function xe(e,r,n,t,o,c,i){return i=i||new a(16),i[0]=2/(r-e),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(t-n),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2/(o-c),i[11]=0,i[12]=(e+r)/(e-r),i[13]=(n+t)/(n-t),i[14]=(o+c)/(o-c),i[15]=1,i}function Te(e,r,n,t,o,c,i){i=i||new a(16);var y=r-e,m=t-n,R=c-o;return i[0]=2*o/y,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*o/m,i[6]=0,i[7]=0,i[8]=(e+r)/y,i[9]=(t+n)/m,i[10]=-(c+o)/R,i[11]=-1,i[12]=0,i[13]=0,i[14]=-2*o*c/R,i[15]=0,i}function Me(e,r,n,t){return t=t||new a(16),t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e,t[13]=r,t[14]=n,t[15]=1,t}function we(e,r,n,t,o){o=o||new a(16);var c=e[0],i=e[1],y=e[2],m=e[3],R=e[1*4+0],x=e[1*4+1],p=e[1*4+2],v=e[1*4+3],D=e[2*4+0],L=e[2*4+1],P=e[2*4+2],B=e[2*4+3],S=e[3*4+0],s=e[3*4+1],U=e[3*4+2],C=e[3*4+3];return e!==o&&(o[0]=c,o[1]=i,o[2]=y,o[3]=m,o[4]=R,o[5]=x,o[6]=p,o[7]=v,o[8]=D,o[9]=L,o[10]=P,o[11]=B),o[12]=c*r+R*n+D*t+S,o[13]=i*r+x*n+L*t+s,o[14]=y*r+p*n+P*t+U,o[15]=m*r+v*n+B*t+C,o}function ye(e,r){r=r||new a(16);var n=Math.cos(e),t=Math.sin(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Re(e,r,n){n=n||new a(16);var t=e[4],o=e[5],c=e[6],i=e[7],y=e[8],m=e[9],R=e[10],x=e[11],p=Math.cos(r),v=Math.sin(r);return n[4]=p*t+v*y,n[5]=p*o+v*m,n[6]=p*c+v*R,n[7]=p*i+v*x,n[8]=p*y-v*t,n[9]=p*m-v*o,n[10]=p*R-v*c,n[11]=p*x-v*i,e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function fe(e,r){r=r||new a(16);var n=Math.cos(e),t=Math.sin(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function he(e,r,n){n=n||new a(16);var t=e[0*4+0],o=e[0*4+1],c=e[0*4+2],i=e[0*4+3],y=e[2*4+0],m=e[2*4+1],R=e[2*4+2],x=e[2*4+3],p=Math.cos(r),v=Math.sin(r);return n[0]=p*t-v*y,n[1]=p*o-v*m,n[2]=p*c-v*R,n[3]=p*i-v*x,n[8]=p*y+v*t,n[9]=p*m+v*o,n[10]=p*R+v*c,n[11]=p*x+v*i,e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function Ve(e,r){r=r||new a(16);var n=Math.cos(e),t=Math.sin(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Xe(e,r,n){n=n||new a(16);var t=e[0*4+0],o=e[0*4+1],c=e[0*4+2],i=e[0*4+3],y=e[1*4+0],m=e[1*4+1],R=e[1*4+2],x=e[1*4+3],p=Math.cos(r),v=Math.sin(r);return n[0]=p*t+v*y,n[1]=p*o+v*m,n[2]=p*c+v*R,n[3]=p*i+v*x,n[4]=p*y-v*t,n[5]=p*m-v*o,n[6]=p*R-v*c,n[7]=p*x-v*i,e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n}function Ee(e,r,n){n=n||new a(16);var t=e[0],o=e[1],c=e[2],i=Math.sqrt(t*t+o*o+c*c);t/=i,o/=i,c/=i;var y=t*t,m=o*o,R=c*c,x=Math.cos(r),p=Math.sin(r),v=1-x;return n[0]=y+(1-y)*x,n[1]=t*o*v+c*p,n[2]=t*c*v-o*p,n[3]=0,n[4]=t*o*v-c*p,n[5]=m+(1-m)*x,n[6]=o*c*v+t*p,n[7]=0,n[8]=t*c*v+o*p,n[9]=o*c*v-t*p,n[10]=R+(1-R)*x,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Oe(e,r,n,t){t=t||new a(16);var o=r[0],c=r[1],i=r[2],y=Math.sqrt(o*o+c*c+i*i);o/=y,c/=y,i/=y;var m=o*o,R=c*c,x=i*i,p=Math.cos(n),v=Math.sin(n),D=1-p,L=m+(1-m)*p,P=o*c*D+i*v,B=o*i*D-c*v,S=o*c*D-i*v,s=R+(1-R)*p,U=c*i*D+o*v,C=o*i*D+c*v,F=c*i*D-o*v,V=x+(1-x)*p,G=e[0],k=e[1],H=e[2],Y=e[3],j=e[4],W=e[5],J=e[6],$=e[7],d=e[8],ee=e[9],ne=e[10],te=e[11];return t[0]=L*G+P*j+B*d,t[1]=L*k+P*W+B*ee,t[2]=L*H+P*J+B*ne,t[3]=L*Y+P*$+B*te,t[4]=S*G+s*j+U*d,t[5]=S*k+s*W+U*ee,t[6]=S*H+s*J+U*ne,t[7]=S*Y+s*$+U*te,t[8]=C*G+F*j+V*d,t[9]=C*k+F*W+V*ee,t[10]=C*H+F*J+V*ne,t[11]=C*Y+F*$+V*te,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t}function qe(e,r,n,t){return t=t||new a(16),t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ze(e,r,n,t,o){return o=o||new a(16),o[0]=r*e[0*4+0],o[1]=r*e[0*4+1],o[2]=r*e[0*4+2],o[3]=r*e[0*4+3],o[4]=n*e[1*4+0],o[5]=n*e[1*4+1],o[6]=n*e[1*4+2],o[7]=n*e[1*4+3],o[8]=t*e[2*4+0],o[9]=t*e[2*4+1],o[10]=t*e[2*4+2],o[11]=t*e[2*4+3],e!==o&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o}function Ne(e,r,n,t){t=t||new a(16);const o=r[0],c=r[1],i=r[2],y=r[3],m=o+o,R=c+c,x=i+i,p=o*m,v=o*R,D=o*x,L=c*R,P=c*x,B=i*x,S=y*m,s=y*R,U=y*x,C=n[0],F=n[1],V=n[2];return t[0]=(1-(L+B))*C,t[1]=(v+U)*C,t[2]=(D-s)*C,t[3]=0,t[4]=(v-U)*F,t[5]=(1-(p+B))*F,t[6]=(P+S)*F,t[7]=0,t[8]=(D+s)*V,t[9]=(P-S)*V,t[10]=(1-(p+L))*V,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Ge(e,r){const n=e[0],t=e[4],o=e[8],c=e[1],i=e[5],y=e[9],m=e[2],R=e[6],x=e[10],p=n+i+x;if(p>0){const v=.5/Math.sqrt(p+1);r[3]=.25/v,r[0]=(R-y)*v,r[1]=(o-m)*v,r[2]=(c-t)*v}else if(n>i&&n>x){const v=2*Math.sqrt(1+n-i-x);r[3]=(R-y)/v,r[0]=.25*v,r[1]=(t+c)/v,r[2]=(o+m)/v}else if(i>x){const v=2*Math.sqrt(1+i-n-x);r[3]=(o-m)/v,r[0]=(t+c)/v,r[1]=.25*v,r[2]=(y+R)/v}else{const v=2*Math.sqrt(1+x-n-i);r[3]=(c-t)/v,r[0]=(o+m)/v,r[1]=(y+R)/v,r[2]=.25*v}}function f(e,r,n,t){let o=m4.length(e.slice(0,3));const c=m4.length(e.slice(4,7)),i=m4.length(e.slice(8,11));E(e)<0&&(o=-o),r[0]=e[12],r[1]=e[13],r[2]=e[14];const m=m4.copy(e),R=1/o,x=1/c,p=1/i;m[0]*=R,m[1]*=R,m[2]*=R,m[4]*=x,m[5]*=x,m[6]*=x,m[8]*=p,m[9]*=p,m[10]*=p,Ge(m,n),t[0]=o,t[1]=c,t[2]=i}function E(e){var r=e[0],n=e[0*4+1],t=e[0*4+2],o=e[0*4+3],c=e[1*4+0],i=e[1*4+1],y=e[1*4+2],m=e[1*4+3],R=e[2*4+0],x=e[2*4+1],p=e[2*4+2],v=e[2*4+3],D=e[3*4+0],L=e[3*4+1],P=e[3*4+2],B=e[3*4+3],S=p*B,s=P*v,U=y*B,C=P*m,F=y*v,V=p*m,G=t*B,k=P*o,H=t*v,Y=p*o,j=t*m,W=y*o,J=S*i+C*x+F*L-(s*i+U*x+V*L),$=s*n+G*x+Y*L-(S*n+k*x+H*L),d=U*n+k*i+j*L-(C*n+G*i+W*L),ee=V*n+H*i+W*x-(F*n+Y*i+j*x);return 1/(r*J+c*$+R*d+D*ee)}function T(e,r){r=r||new a(16);var n=e[0*4+0],t=e[0*4+1],o=e[0*4+2],c=e[0*4+3],i=e[1*4+0],y=e[1*4+1],m=e[1*4+2],R=e[1*4+3],x=e[2*4+0],p=e[2*4+1],v=e[2*4+2],D=e[2*4+3],L=e[3*4+0],P=e[3*4+1],B=e[3*4+2],S=e[3*4+3],s=v*S,U=B*D,C=m*S,F=B*R,V=m*D,G=v*R,k=o*S,H=B*c,Y=o*D,j=v*c,W=o*R,J=m*c,$=x*P,d=L*p,ee=i*P,ne=L*y,te=i*p,ge=x*y,Ae=n*P,Le=L*t,be=n*p,De=x*t,Pe=n*y,Be=i*t,Ke=s*y+F*p+V*P-(U*y+C*p+G*P),Qe=U*t+k*p+j*P-(s*t+H*p+Y*P),Je=C*t+H*y+W*P-(F*t+k*y+J*P),$e=G*t+Y*y+J*p-(V*t+j*y+W*p),Z=1/(n*Ke+i*Qe+x*Je+L*$e);return r[0]=Z*Ke,r[1]=Z*Qe,r[2]=Z*Je,r[3]=Z*$e,r[4]=Z*(U*i+C*x+G*L-(s*i+F*x+V*L)),r[5]=Z*(s*n+H*x+Y*L-(U*n+k*x+j*L)),r[6]=Z*(F*n+k*i+J*L-(C*n+H*i+W*L)),r[7]=Z*(V*n+j*i+W*x-(G*n+Y*i+J*x)),r[8]=Z*($*R+ne*D+te*S-(d*R+ee*D+ge*S)),r[9]=Z*(d*c+Ae*D+De*S-($*c+Le*D+be*S)),r[10]=Z*(ee*c+Le*R+Pe*S-(ne*c+Ae*R+Be*S)),r[11]=Z*(ge*c+be*R+Be*D-(te*c+De*R+Pe*D)),r[12]=Z*(ee*v+ge*B+d*m-(te*B+$*m+ne*v)),r[13]=Z*(be*B+$*o+Le*v-(Ae*v+De*B+d*o)),r[14]=Z*(Ae*m+Be*B+ne*o-(Pe*B+ee*o+Le*m)),r[15]=Z*(Pe*v+te*o+De*m-(be*m+Be*v+ge*o)),r}function I(e,r,n){n=n||new a(4);for(var t=0;t<4;++t){n[t]=0;for(var o=0;o<4;++o)n[t]+=r[o]*e[o*4+t]}return n}function q(e,r,n){n=n||new a(3);var t=r[0],o=r[1],c=r[2],i=t*e[0*4+3]+o*e[1*4+3]+c*e[2*4+3]+e[3*4+3];return n[0]=(t*e[0*4+0]+o*e[1*4+0]+c*e[2*4+0]+e[3*4+0])/i,n[1]=(t*e[0*4+1]+o*e[1*4+1]+c*e[2*4+1]+e[3*4+1])/i,n[2]=(t*e[0*4+2]+o*e[1*4+2]+c*e[2*4+2]+e[3*4+2])/i,n}function z(e,r,n){n=n||new a(3);var t=r[0],o=r[1],c=r[2];return n[0]=t*e[0*4+0]+o*e[1*4+0]+c*e[2*4+0],n[1]=t*e[0*4+1]+o*e[1*4+1]+c*e[2*4+1],n[2]=t*e[0*4+2]+o*e[1*4+2]+c*e[2*4+2],n}function re(e,r,n){n=n||new a(3);var t=T(e),o=r[0],c=r[1],i=r[2];return n[0]=o*t[0*4+0]+c*t[0*4+1]+i*t[0*4+2],n[1]=o*t[1*4+0]+c*t[1*4+1]+i*t[1*4+2],n[2]=o*t[2*4+0]+c*t[2*4+1]+i*t[2*4+2],n}function pe(e,r){return r=r||new a(16),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}return{copy:pe,lookAt:ie,addVectors:M,subtractVectors:_,scaleVector:w,distance:ue,distanceSq:K,normalize:g,compose:Ne,cross:b,decompose:f,dot:oe,identity:le,transpose:Q,length:A,lengthSq:N,orthographic:xe,frustum:Te,perspective:ve,translation:Me,translate:we,xRotation:ye,yRotation:fe,zRotation:Ve,xRotate:Re,yRotate:he,zRotate:Xe,axisRotation:Ee,axisRotate:Oe,scaling:qe,scale:ze,multiply:h,inverse:T,transformVector:I,transformPoint:q,transformDirection:z,transformNormal:re,setDefaultType:l}});var xr=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif

varying vec2 vTextureCoords;
uniform sampler2D textureUnit;

void main() {
    vec4 texture = texture2D(textureUnit, vTextureCoords);
    gl_FragColor = texture;
}`,Er=`attribute vec3 vertex;
attribute vec2 textureCoords;
uniform mat4 ModelViewMatrix, ProjectionMatrix;
varying vec2 vTextureCoords;

void main() {
    vec4 vertPos4 = ModelViewMatrix * vec4(vertex, 1.0);
    vec3 vertPos = vec3(vertPos4) / vertPos4.w;
    gl_Position = ProjectionMatrix*vertPos4;
    vTextureCoords = textureCoords;
}`,Se=!1;function Tr(a,l,h,M,_){var w=new Array(3),g=new Array(3),A=new Array(3),N,b;this.setView=function(f,E,T){A=E===void 0?[0,0,10]:E,T=T===void 0?[0,1,0]:T,N=f,Ee(A,A),Oe(g,A),Ne(g,g,Ve(A,T)),ze(g,T,g),Ee(g,g),Ge(w,g,A)},this.getViewMatrix=function(){var f=[w[0],g[0],A[0],0,w[1],g[1],A[1],0,w[2],g[2],A[2],0,0,0,0,1];if(b!==void 0){var E=b[0]-f[0]*b[0]-f[4]*b[1]-f[8]*b[2],T=b[1]-f[1]*b[0]-f[5]*b[1]-f[9]*b[2],I=b[2]-f[2]*b[0]-f[6]*b[1]-f[10]*b[2];f[12]=E,f[13]=T,f[14]=I}return N!==void 0&&(f[14]-=N),f},this.getViewDistance=function(){return N},this.setViewDistance=function(f){N=f},this.getRotationCenter=function(){return b===void 0?[0,0,0]:b},this.setRotationCenter=function(f){b=f},this.setView(h,M,_),a.addEventListener("mousedown",xe,!1),a.addEventListener("touchstart",we,!1);function oe(f,E){function T(z,re,pe){var e=2*(z[0]*re[0]+z[1]*re[1]+z[2]*re[2]);pe[0]=e*z[0]-re[0],pe[1]=e*z[1]-re[1],pe[2]=e*z[2]-re[2]}Ee(f,f),Ee(E,E);var I=[0,0,0];qe(I,f,E),Ee(I,I);var q=[0,0,0];T(I,A,q),T(f,q,A),T(I,w,q),T(f,q,w),T(I,g,q),T(f,q,g)}var K,ue,le,Q,ie,ve=!1;function xe(f){if(!ve){ve=!0,K=a.width/2,ue=a.height/2;var E=Math.min(K,ue);le=E*E,document.addEventListener("mousemove",Te,!1),document.addEventListener("mouseup",Me,!1);var T=a.getBoundingClientRect();Q=f.clientX-T.left,ie=f.clientY-T.top}}function Te(f){if(!!ve){var E=a.getBoundingClientRect(),T=f.clientX-E.left,I=f.clientY-E.top,q=he(Q,ie),z=he(T,I);oe(q,z),Q=T,ie=I,l&&l()}}function Me(f){ve&&(document.removeEventListener("mousemove",Te,!1),document.removeEventListener("mouseup",Me,!1),ve=!1)}function we(f){if(f.touches.length!=1){fe();return}f.preventDefault();var E=a.getBoundingClientRect();Q=f.touches[0].clientX-E.left,ie=f.touches[0].clientY-E.top,a.addEventListener("touchmove",ye,!1),a.addEventListener("touchend",Re,!1),a.addEventListener("touchcancel",fe,!1),Se=!0,K=a.width/2,ue=a.height/2;var T=Math.min(K,ue);le=T*T}function ye(f){if(f.touches.length!=1||!Se){fe();return}f.preventDefault();var E=a.getBoundingClientRect(),T=f.touches[0].clientX-E.left,I=f.touches[0].clientY-E.top,q=he(Q,ie),z=he(T,I);oe(q,z),Q=T,ie=I,l&&l()}function Re(f){fe()}function fe(){Se&&(Se=!1,a.removeEventListener("touchmove",ye,!1),a.removeEventListener("touchend",Re,!1),a.removeEventListener("touchcancel",fe,!1))}function he(f,E){var T=f-K,I=ue-E,q=T*w[0]+I*g[0],z=T*w[1]+I*g[1],re=T*w[2]+I*g[2],pe=q*q+z*z+re*re;if(pe>le)return[q,z,re];var e=Math.sqrt(le-pe);return[q+e*A[0],z+e*A[1],re+e*A[2]]}function Ve(f,E){return f[0]*E[0]+f[1]*E[1]+f[2]*E[2]}function Xe(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2])}function Ee(f,E){var T=Xe(E);f[0]=E[0]/T,f[1]=E[1]/T,f[2]=E[2]/T}function Oe(f,E){f[0]=E[0],f[1]=E[1],f[2]=E[2]}function qe(f,E,T){f[0]=E[0]+T[0],f[1]=E[1]+T[1],f[2]=E[2]+T[2]}function ze(f,E,T){f[0]=E[0]-T[0],f[1]=E[1]-T[1],f[2]=E[2]-T[2]}function Ne(f,E,T){f[0]=E[0]*T,f[1]=E[1]*T,f[2]=E[2]*T}function Ge(f,E,T){var I=E[1]*T[2]-E[2]*T[1],q=E[2]*T[0]-E[0]*T[2],z=E[0]*T[1]-E[1]*T[0];f[0]=I,f[1]=q,f[2]=z}}const cr=[{id:"eyeSeparation",label:"Eye Separation",min:0,max:10,step:.01,value:2,elementRef:null},{id:"fov",label:"Field of View",min:.5,max:3,step:.01,value:1.45,elementRef:null},{id:"nearClippingDistance",label:"Near Clipping Distance",min:1,max:20,step:.5,value:10,elementRef:null},{id:"convergenceDistance",label:"Convergence distance",min:1,max:100,step:1,value:40,elementRef:null}],Mr=a=>{const l=document.querySelector(a);l.innerHTML="",cr.forEach(h=>{const M=document.createElement("div"),_=document.createElement("div");_.classList.add("title-wrapper");const w=document.createElement("label");w.setAttribute("for",h.id),w.innerHTML=h.label;const g=document.createElement("span");g.setAttribute("class","slider-value"),g.innerHTML=h.value;const A=document.createElement("input");A.setAttribute("id",h.id),A.setAttribute("type","range"),A.setAttribute("min",h.min),A.setAttribute("max",h.max),A.setAttribute("step",h.step),A.setAttribute("value",h.value),A.addEventListener("input",N=>{g.innerHTML=N.target.value}),h.elementRef=A,M.appendChild(_),_.appendChild(w),_.appendChild(g),M.appendChild(A),l.appendChild(M)})},Ce=a=>{var h;const l=cr.find(M=>M.id===a);return parseFloat((h=l==null?void 0:l.elementRef)==null?void 0:h.value,10)},yr=()=>new Promise(async(a,l)=>{try{const h=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});a(h)}catch(h){l(h)}}),Rr=()=>document.getElementById("webcam").checked,wr=a=>{const l=document.getElementById("webcam");l.addEventListener("change",async h=>{l.checked?a.srcObject=await yr():a.srcObject=null})},_r=a=>{const l=a.createTexture();return a.bindTexture(a.TEXTURE_2D,l),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),l};let _e=null;const me={alpha:0,beta:0,gamma:0,event:null},de=async()=>{if(!(typeof DeviceOrientationEvent>"u"||typeof DeviceOrientationEvent.requestPermission!="function"))try{await DeviceOrientationEvent.requestPermission()==="granted"&&(console.log("Permission granted"),window.removeEventListener("deviceorientation",_e,!0),_e=l=>{me.alpha=l.alpha,me.beta=l.beta,me.gamma=l.gamma,me.event=l},window.addEventListener("deviceorientation",_e,!0))}catch{console.error("No device orientation permission")}},gr=async()=>{const a=document.getElementById("device-orientation");a.checked?de().catch(console.error):window.removeEventListener("deviceorientation",_e,!0),a.addEventListener("change",async l=>{a.checked?de().catch(console.error):window.removeEventListener("deviceorientation",_e,!0)})},Ar=a=>new Promise((l,h)=>{const M=new XMLHttpRequest;M.open("GET",a,!0),M.responseType="arraybuffer",M.onload=function(_){l(M.response)},M.send()});let O,ae,ce;const Lr=async a=>{ce=new AudioContext;const l=ce.createGain();l.connect(ce.destination);const h={source:ce.createBufferSource(),volume:ce.createGain()};h.source.connect(h.volume),h.volume.connect(l),h.source.loop=!0;const M=await Ar(a);try{h.buffer=await ce.decodeAudioData(M),h.source.buffer=h.buffer,h.source.start(ce.currentTime)}catch(_){console.error(_)}return O=ce.createPanner(),ae=ce.createBiquadFilter(),h.source.connect(O),O.connect(ae),ae.connect(ce.destination),ae.type="peaking",ae.frequency.value=1e3,ae.gain.value=25,ae.Q.value=1,[h,O]},br=()=>{const a=document.getElementById("filter");a.addEventListener("change",async l=>{var h,M,_;a.checked?(O==null||O.disconnect(),(h=O==null?void 0:O.connect)==null||h.call(O,ae),(M=ae==null?void 0:ae.connect)==null||M.call(ae,ce.destination)):(O==null||O.disconnect(),(_=O==null?void 0:O.connect)==null||_.call(O,ce.destination))})},Dr=a=>a*Math.PI/180;let u,Ue,He,X,ur,Ye,vr,Ie,Pr,se,je,fr,er=0,Fe=[0,0,0];function ke(a){this.name=a,this.iVertexBuffer=u.createBuffer(),this.iTextureBuffer=u.createBuffer(),this.count=0,this.BufferData=function(l,h){u.bindBuffer(u.ARRAY_BUFFER,this.iVertexBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STREAM_DRAW),u.bindBuffer(u.ARRAY_BUFFER,this.iTextureBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(h),u.STREAM_DRAW),u.enableVertexAttribArray(X.iTextureCoords),u.vertexAttribPointer(X.iTextureCoords,2,u.FLOAT,!1,0,0),this.count=l.length/3},this.Draw=function(){u.bindBuffer(u.ARRAY_BUFFER,this.iVertexBuffer),u.vertexAttribPointer(X.iAttribVertex,3,u.FLOAT,!1,0,0),u.enableVertexAttribArray(X.iAttribVertex),u.bindBuffer(u.ARRAY_BUFFER,this.iTextureBuffer),u.vertexAttribPointer(X.iTextureCoords,2,u.FLOAT,!1,0,0),u.enableVertexAttribArray(X.iTextureCoords),u.drawArrays(u.TRIANGLE_STRIP,0,this.count)},this.DrawSphere=function(){this.Draw(),u.drawArrays(u.LINE_STRIP,0,this.count)}}function Br(a,l){this.name=a,this.prog=l,this.iAttribVertex=-1,this.iTextureCoords=-1,this.iTextureUnit=-1,this.Use=function(){u.useProgram(this.prog)}}function lr(){u.clearColor(1,1,1,1),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT);const a=Ce("eyeSeparation"),l=Ce("fov"),h=Ce("nearClippingDistance"),M=Ce("convergenceDistance"),_=2e3;let w,g,A,N;A=h*Math.tan(l/2),N=-A;const b=Math.tan(l/2)*M,oe=b-a/2,K=b+a/2;w=-oe*h/M,g=K*h/M;const ue=m4.orthographic(w,g,N,A,h,_);w=-K*h/M,g=oe*h/M;const le=m4.orthographic(w,g,N,A,h,_);let Q;if(fr.checked&&me.alpha&&me.beta&&me.gamma){const fe=me.alpha*(Math.PI/180);ir(fe+Math.PI/2)}else er+=.02,ir(er);Q=ur.getViewMatrix();const ie=m4.axisRotation([.707,.707,0],0),ve=m4.translation(-.01,0,-20),xe=m4.translation(.01,0,-20);if(Rr()){const fe=m4.orthographic(0,1,0,1,-1,1),he=m4.multiply(ie,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);u.uniformMatrix4fv(X.iModelViewMatrix,!1,he),u.uniformMatrix4fv(X.iProjectionMatrix,!1,fe),u.bindTexture(u.TEXTURE_2D,vr),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Ie),He.Draw()}se==null||se.setPosition(...Fe),u.bindTexture(u.TEXTURE_2D,null);const Te=m4.perspective(Dr(90),1,.1,100),Me=m4.translation(...Fe),we=m4.multiply(Me,Q);u.uniformMatrix4fv(X.iProjectionMatrix,!1,Te),u.uniformMatrix4fv(X.iModelViewMatrix,!1,we),je.DrawSphere(),u.bindTexture(u.TEXTURE_2D,Ye),u.clear(u.DEPTH_BUFFER_BIT);const ye=m4.multiply(ve,Q);u.uniformMatrix4fv(X.iModelViewMatrix,!1,ye),u.uniformMatrix4fv(X.iProjectionMatrix,!1,ue),u.colorMask(!0,!1,!1,!1),Ue.Draw(),u.clear(u.DEPTH_BUFFER_BIT);const Re=m4.multiply(xe,Q);u.uniformMatrix4fv(X.iModelViewMatrix,!1,Re),u.uniformMatrix4fv(X.iProjectionMatrix,!1,le),u.colorMask(!1,!0,!0,!1),Ue.Draw(),u.colorMask(!0,!0,!0,!0)}let Ze=1;function Sr(a,l){return a*Math.cos(l)/Ze}function Cr(a,l){return a*Math.sin(l)/Ze}function Ir(a,l,h,M,_,w,g){let A=M*Math.PI/h;return _*Math.pow(Math.E,-w*a)*Math.sin(A*a+g)/Ze}let We=6,rr=6,nr=4,tr=.5,ar=0;const hr=We,pr=2*Math.PI,sr=(a,l)=>[a/pr,l/hr],or=(a,l,h,M,_,w,g,A,N)=>{const b=Sr(a,l),oe=Cr(a,l),K=Ir(a,l,h,M,_,w,g);A.push(b,oe,K),N.push(...sr(l,a))};function Ur(){const a=[],l=[];for(let h=0;h<=hr;h+=.001)for(let M=0;M<pr;M+=.5)or(h,M,We,rr,nr,tr,ar,a,l),or(h+.5,M+.5,We,rr,nr,tr,ar,a,l);return{vertexList:a,textureList:l}}function Fr(a,l,h){const M=[],_=[];for(let w=0;w<=l;w++){const g=w*Math.PI/l,A=Math.sin(g),N=Math.cos(g);for(let b=0;b<=h;b++){const oe=b*2*Math.PI/h,K=Math.sin(oe),ue=Math.cos(oe),le=a*ue*A,Q=a*N,ie=a*K*A;M.push(le,Q,ie);const ve=1-b/h,xe=1-w/l;_.push(ve,xe)}}return{vertexList:M,textureList:_}}function Vr(){let a=Xr(u,Er,xr);X=new Br("Basic",a),X.Use(),X.iAttribVertex=u.getAttribLocation(a,"vertex"),X.iModelViewMatrix=u.getUniformLocation(a,"ModelViewMatrix"),X.iProjectionMatrix=u.getUniformLocation(a,"ProjectionMatrix"),X.iTextureCoords=u.getAttribLocation(a,"textureCoords"),X.iTextureUnit=u.getUniformLocation(a,"textureUnit"),Ue=new ke("Surface");const{vertexList:l,textureList:h}=Ur();Ue.BufferData(l,h),He=new ke("Background"),He.BufferData([0,0,0,1,0,0,1,1,0,1,1,0,0,1,0,0,0,0],[1,1,0,1,0,0,0,0,1,0,1,1]);const M=Fr(.5,500,500);je=new ke("Sphere"),je.BufferData(M.vertexList,M.textureList),Gr(),u.enable(u.DEPTH_TEST)}function mr(){lr(),window.requestAnimationFrame(mr)}function Xr(a,l,h){let M=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(M,l),a.compileShader(M),!a.getShaderParameter(M,a.COMPILE_STATUS))throw new Error("Error in vertex shader:  "+a.getShaderInfoLog(M));let _=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(_,h),a.compileShader(_),!a.getShaderParameter(_,a.COMPILE_STATUS))throw new Error("Error in fragment shader:  "+a.getShaderInfoLog(_));let w=a.createProgram();if(a.attachShader(w,M),a.attachShader(w,_),a.linkProgram(w),!a.getProgramParameter(w,a.LINK_STATUS))throw new Error("Link error in program:  "+a.getProgramInfoLog(w));return w}const Or=()=>{document.getElementById("request-orientation").addEventListener("click",()=>{gr()})},qr=()=>{document.getElementById("audio").addEventListener("click",async l=>{[Pr,se]=await Lr("audio.mp3").catch(console.error)})};function ir(a,l=0,h=-5,M=4){Fe[0]=l+Math.cos(a)*M,Fe[2]=h+Math.sin(a)*M}async function zr(){Mr("#controls");let a;try{if(a=document.getElementById("webglcanvas"),u=a.getContext("webgl"),Ie=document.createElement("video"),Ie.setAttribute("autoplay","true"),fr=document.getElementById("device-orientation"),vr=_r(u),wr(Ie),Or(),qr(),br(),!u)throw"Browser does not support WebGL"}catch{document.getElementById("canvas-holder").innerHTML="<p>Sorry, could not get a WebGL graphics context.</p>";return}try{Vr()}catch(l){document.getElementById("canvas-holder").innerHTML="<p>Sorry, could not initialize the WebGL graphics context: "+l+"</p>";return}ur=new Tr(a,lr,0),mr()}async function Nr(){return new Promise((a,l)=>{const h=new Image;h.src="texture.png",h.crossOrigin="anonymous",h.addEventListener("load",function(){a(h)})})}const Gr=async()=>{const a=await Nr();Ye=u.createTexture(),u.bindTexture(u.TEXTURE_2D,Ye),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,a)};document.addEventListener("DOMContentLoaded",zr);
